/*TABLES*/
-----------------------------------------------------------------

CREATE TABLE EMPLOYEE
(
    EMPLOYEE_ID   NUMBER(4),
    DNI           VARCHAR2(9 CHAR)  NOT NULL,
    NAME          VARCHAR2(20 CHAR) NOT NULL,
    FIRST_SURNAME VARCHAR2(50 CHAR) NOT NULL,
    BIRTH_DATE    DATE              NOT NULL,
    NATIONALITY   VARCHAR2(20 CHAR) NOT NULL,
    ROLE          VARCHAR2(10)      NOT NULL,
    EMAIL         VARCHAR2(50)      NOT NULL,
    PASSWORD      VARCHAR2(20 CHAR) NOT NULL,
    ACTIVE        NUMBER(1) DEFAULT 1,
    CONSTRAINT ID_EMP_PK PRIMARY KEY (EMPLOYEE_ID),
    CONSTRAINT EMP_ROL_CK CHECK (ROLE IN ('ADMIN', 'EMPLEADO'))
);

CREATE TABLE CLIENT
(
    CLIENT_ID      NUMBER(4),
    DNI            VARCHAR2(9 CHAR)  NOT NULL,
    NAME           VARCHAR2(20 CHAR) NOT NULL,
    FIRST_SURNAME  VARCHAR2(50 CHAR) NOT NULL,
    SECOND_SURNAME VARCHAR2(50 CHAR),
    BIRTH_DATE     DATE              NOT NULL,
    PROFESSION     VARCHAR2(20),
    ACTIVE         NUMBER(1) DEFAULT 1,
    CONSTRAINT ID_CLI_PK PRIMARY KEY (CLIENT_ID)
);

CREATE TABLE TOUR
(
    TOUR_ID        NUMBER(4),
    EMPLOYEE_ID    NUMBER(4),
    TITLE          VARCHAR2(50 CHAR)  NOT NULL,
    DESCRIPTION    VARCHAR2(50 CHAR),
    TOPIC          VARCHAR2(25 CHAR)  NOT NULL,
    PLACE          VARCHAR2(50 CHAR)  NOT NULL,
    STARTING_POINT VARCHAR2(100 CHAR) NOT NULL,
    MAX_ATTENDEES  NUMBER(3)          NOT NULL,
    PRICE          NUMBER(4, 2)       NOT NULL,
    START_DATE     TIMESTAMP          NOT NULL,
    CANCELLED      NUMBER(1) DEFAULT 0,
    CONSTRAINT TOU_ID_PK PRIMARY KEY (TOUR_ID),
    CONSTRAINT TOU_EMP_FK FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE ON DELETE SET NULL,
    CONSTRAINT TOU_TOP_CK CHECK (TOPIC IN ('ACTIVIDAD_FAMILIAR', 'CONCIERTO', 'DANZA_TEATRO', 'DEPORTES',
                                           'EVENTOS_GASTRONOMICOS', 'EXPOSICIONES', 'FESTIVALES', 'FIESTAS_TRADICIONES',
                                           'CONGRESOS_FERIAS', 'RUTAS', 'OTROS'))
);

CREATE TABLE EMPLOYEE_REGISTRATION_CANCELLATION
(
    REGISTRATION_CANCELLATION_ID NUMBER(4),
    EMPLOYEE_ID                  NUMBER(4),
    START_DATE                   DATE DEFAULT (SYSDATE) NOT NULL,
    END_DATE                     DATE,
    CONSTRAINT EMP_REG_CAN_ID_PK PRIMARY KEY (REGISTRATION_CANCELLATION_ID),
    CONSTRAINT EMP_REG_CAN_EMP_FK FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE ON DELETE CASCADE
);

CREATE TABLE CLIENT_REGISTRATION_CANCELLATION
(
    REGISTRATION_CANCELLATION_ID NUMBER(4),
    CLIENT_ID                    NUMBER(4),
    START_DATE                   DATE DEFAULT (SYSDATE) NOT NULL,
    END_DATE                     DATE,
    CONSTRAINT CLI_REG_CAN_ID_PK PRIMARY KEY (REGISTRATION_CANCELLATION_ID),
    CONSTRAINT CLI_REG_CAN_EMP_FK FOREIGN KEY (CLIENT_ID) REFERENCES CLIENT ON DELETE CASCADE
);

CREATE TABLE CLIENT_TOUR
(
    CLIENT_ID NUMBER(4),
    TOUR_ID   NUMBER(4),
    CONSTRAINT CLI_ID_FK FOREIGN KEY (CLIENT_ID) REFERENCES CLIENT (CLIENT_ID) ON DELETE CASCADE,
    CONSTRAINT TOU_CLI_ID_FK FOREIGN KEY (TOUR_ID) REFERENCES TOUR (TOUR_ID) ON DELETE CASCADE
);

CREATE TABLE BONUS
(
    BONUS_ID         NUMBER(4),
    CLIENT_ID        NUMBER(4),
    BONUS_TYPE       NUMBER(2)              NOT NULL,
    DESCRIPTION      VARCHAR2(20)           NOT NULL,
    ATTAINTMENT_DATE DATE DEFAULT (SYSDATE) NOT NULL,
    CONSTRAINT BON_ID_PK PRIMARY KEY (BONUS_ID),
    CONSTRAINT BON_CLI_FK FOREIGN KEY (CLIENT_ID) REFERENCES CLIENT ON DELETE CASCADE,
    CONSTRAINT BON_TYP_CK CHECK (BONUS_TYPE IN (5, 10, 15, 20, 25))
);

CREATE TABLE EMPLOYEE_CLOCK_IN_CLOCK_OUT
(
    SESSION_ID  NUMBER(4),
    EMPLOYEE_ID NUMBER(4),
    START_DATE  TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL,
    END_DATE    TIMESTAMP,
    CONSTRAINT ID_SES_PK PRIMARY KEY (SESSION_ID),
    CONSTRAINT SES_EMP_FK FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE ON DELETE CASCADE
);

/*SECUENCIAS*/
-----------------------------------------------------------------

CREATE SEQUENCE EMPLOYEE_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE CLIENT_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE TOUR_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE EMPLOYEE_REGISTRATION_CANCELLATION_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE CLIENT_REGISTRATION_CANCELLATION_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE BONUS_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

CREATE SEQUENCE EMPLOYEE_CLOCK_IN_CLOCK_OUT_ID_SEQ
    INCREMENT BY 1
    START WITH 1
    MAXVALUE 9999
    NOCYCLE;

/*INSERTS*/
-----------------------------------------------------------------

Insert into ASIER.BONUS (BONUS_ID,CLIENT_ID,BONUS_TYPE,DESCRIPTION,ATTAINTMENT_DATE) values ('61','83','5','5% descuento',to_date('26/10/20','DD/MM/RR'));

Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('85','123456','JOSEBA','ESCOBAR','ESCOBAR',to_date('01/10/20','DD/MM/RR'),'PROFESION','1');
Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('83','123456','ERIKA','ALCALA','ALCALA',to_date('08/10/20','DD/MM/RR'),'PROFESION','1');
Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('84','123456','SIMONA','SANCHO','SANCHO',to_date('01/10/20','DD/MM/RR'),'PROFESION','1');
Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('81','123456','OTILIA','MOTA','MOTA',to_date('01/10/20','DD/MM/RR'),'PROFESION','1');
Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('82','123456','PATRICIA','VILLAR','VILLAR',to_date('01/10/20','DD/MM/RR'),'PROFESION','1');
Insert into ASIER.CLIENT (CLIENT_ID,DNI,NAME,FIRST_SURNAME,SECOND_SURNAME,BIRTH_DATE,PROFESSION,ACTIVE) values ('86','123456','DULCE','DE LA CRUZ','DE LA CRUZ',to_date('15/07/20','DD/MM/RR'),'PROFESION','1');

Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('85','85',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('83','83',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('84','84',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('86','86',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('81','81',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.CLIENT_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,CLIENT_ID,START_DATE,END_DATE) values ('82','82',to_date('26/10/20','DD/MM/RR'),null);

Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','167');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('85','162');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','162');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('84','162');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('81','162');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('85','163');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','163');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('84','163');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('81','163');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('86','163');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('85','161');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','161');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','166');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('82','166');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('82','165');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','165');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('85','165');
Insert into ASIER.CLIENT_TOUR (CLIENT_ID,TOUR_ID) values ('83','168');

Insert into ASIER.EMPLOYEE (EMPLOYEE_ID,DNI,NAME,FIRST_SURNAME,BIRTH_DATE,NATIONALITY,ROLE,EMAIL,PASSWORD,ACTIVE) values ('666','123456','ASIER','ORTIZ',to_date('01/10/20','DD/MM/RR'),'ESPAÑOL','ADMIN','asier@test.com','123456','1');
Insert into ASIER.EMPLOYEE (EMPLOYEE_ID,DNI,NAME,FIRST_SURNAME,BIRTH_DATE,NATIONALITY,ROLE,EMAIL,PASSWORD,ACTIVE) values ('223','123456','MATIAS','GALLARDO',to_date('01/10/20','DD/MM/RR'),'CHINO','EMPLEADO','matias@test.com','123456','1');
Insert into ASIER.EMPLOYEE (EMPLOYEE_ID,DNI,NAME,FIRST_SURNAME,BIRTH_DATE,NATIONALITY,ROLE,EMAIL,PASSWORD,ACTIVE) values ('222','123456','ANDER','MILLAN',to_date('01/10/20','DD/MM/RR'),'ESPAÑOL','ADMIN','ander@test.com','123456','1');
Insert into ASIER.EMPLOYEE (EMPLOYEE_ID,DNI,NAME,FIRST_SURNAME,BIRTH_DATE,NATIONALITY,ROLE,EMAIL,PASSWORD,ACTIVE) values ('221','123456','SVETA','VYKHOR',to_date('02/09/20','DD/MM/RR'),'UCRANIANA','ADMIN','sveta@test.com','123456','1');

Insert into ASIER.EMPLOYEE_CLOCK_IN_CLOCK_OUT (SESSION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('642','666',to_timestamp('26/10/20 11:12:45,763000000','DD/MM/RR HH24:MI:SSXFF'),to_timestamp('26/10/20 11:22:16,672000000','DD/MM/RR HH24:MI:SSXFF'));
Insert into ASIER.EMPLOYEE_CLOCK_IN_CLOCK_OUT (SESSION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('641','666',to_timestamp('26/10/20 11:09:48,609000000','DD/MM/RR HH24:MI:SSXFF'),to_timestamp('26/10/20 11:12:37,580000000','DD/MM/RR HH24:MI:SSXFF'));

Insert into ASIER.EMPLOYEE_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('143','221',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.EMPLOYEE_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('144','223',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.EMPLOYEE_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('142','222',to_date('26/10/20','DD/MM/RR'),null);
Insert into ASIER.EMPLOYEE_REGISTRATION_CANCELLATION (REGISTRATION_CANCELLATION_ID,EMPLOYEE_ID,START_DATE,END_DATE) values ('141','221',to_date('26/10/20','DD/MM/RR'),to_date('26/10/20','DD/MM/RR'));

Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('163','221','TITLE','DESCRIPTION','EXPOSICIONES','PLACE','POINT','22','31',to_timestamp('08/01/21 03:00:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('166','222','TITLE','DESCRIPTION','EVENTOS_GASTRONOMICOS','PLACE','POINT','45','44',to_timestamp('11/12/20 03:30:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('161','666','TITLE','DESCRIPTION','ACTIVIDAD_FAMILIAR','PLACE','POINT','22','33,2',to_timestamp('31/12/20 04:00:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('162','223','TITLE','DESCRIPTION','CONGRESOS_FERIAS','PLACE','POINT','4','25',to_timestamp('16/01/21 06:00:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('167','222','TITLE','DESCRIPTION','DEPORTES','PLACE','POINT','22','11',to_timestamp('15/11/20 02:00:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'1');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('168','222','TITLE','DESCRIPTION','ACTIVIDAD_FAMILIAR','PLACE','POINT','22','31',to_timestamp('29/11/20 07:00:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('164','666','TITLE','DESCRIPTION','FIESTAS_TRADICIONES','PLACE','POINT','22','55',to_timestamp('08/09/20 01:30:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');
Insert into ASIER.TOUR (TOUR_ID,EMPLOYEE_ID,TITLE,DESCRIPTION,TOPIC,PLACE,STARTING_POINT,MAX_ATTENDEES,PRICE,START_DATE,CANCELLED) values ('165','223','TITLE','DESCRIPTION','OTROS','PLACE','POINT','23','11',to_timestamp('20/11/20 04:30:00,000000000','DD/MM/RR HH24:MI:SSXFF'),'0');

-----------------------------------------------------------------